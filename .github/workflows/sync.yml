name: ğŸ”„ Sync fork with upstream

on:
  schedule:
    - cron: '0 3 * * *'  # æ¯å¤© UTC æ—¶é—´ 3 ç‚¹è‡ªåŠ¨è¿è¡Œï¼ˆå³åŒ—äº¬æ—¶é—´ 11 ç‚¹ï¼‰
  workflow_dispatch:     # å…è®¸ä½ æ‰‹åŠ¨ç‚¹å‡»è¿è¡Œ

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ›ï¸ Checkout your fork
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0  # è·å–å®Œæ•´å†å²

      - name: ğŸ”— Set upstream remote
        run: |
          git remote add upstream https://github.com/openclaw/openclaw.git
          git fetch upstream

      - name: ğŸ”„ Merge upstream into your default branch
        run: |
          # æ›¿æ¢ä¸ºä½ çš„é»˜è®¤åˆ†æ”¯åï¼Œé€šå¸¸æ˜¯ main æˆ– master
          BRANCH="main"
          
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          
          # å°è¯•åˆå¹¶ï¼Œå¦‚æœæ²¡å˜åŒ–æˆ–å†²çªå°±è·³è¿‡
          git merge upstream/$BRANCH || echo "âš ï¸ Merge failed or no changes."

      - name: ğŸ“¤ Push to your fork
        run: |
          BRANCH="main"
          git push origin $BRANCH
